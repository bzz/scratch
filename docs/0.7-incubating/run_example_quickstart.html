<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Apache Flink (incubating): Quick Start: Run K-Means Example</title>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/bootstrap-lumen-custom.css">
    <link rel="stylesheet" href="css/syntax.css">
    <link rel="stylesheet" href="css/custom.css">
    <link href="css/main/main.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/codetabs.js"></script>
  </head>
  <body>

    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="row">
      <div class="col-md-1 af-mobile-nav-bar">
	<a href="index.html" title="Home">
	  <img class="hidden-xs hidden-sm img-responsive"
	       src="img/logo.png" alt="Apache Flink Logo">
	</a>	
	<div class="row visible-xs">
	  <div class="col-xs-3">
	    <a href="index.html" title="Home">  
	      <img class="hidden-x hidden-sm img-responsive"
		   src="img/logo.png" alt="Apache Flink Logo">
	    </a>	
	  </div>
	  <div class="col-xs-5"></div>
	  <div class="col-xs-4">
	    <div class="af-mobile-btn">
	      <span class="glyphicon glyphicon-plus"></span>
	    </div>
	  </div>
	</div>
      </div>
      <!-- Navigation -->
      <div class="col-md-11">
	<div class="collapse navbar-collapse" id="navbar-collapse-1">
	  <ul class="nav navbar-nav">

	    <li>
	      <a href="index.html" class="">Documentation</a>
	    </li>

	    <li>
	      <a href="api/java/index.html">Javadoc</a>
	    </li>

	    <li>
	      <a href="api/scala/index.html#org.apache.flink.api.scala.package">Scaladoc</a>
	    </li>

	  </ul>
	</div>
      </div>
    </div>
  </div>
</nav>


    <div style="padding-top:120px" class="container">

      <div class="row">
        <div class="col-md-3">
          <ul>
  <li><a href="faq.html">FAQ</a></li>
  <li>Quickstart
    <ul>
      <li><a href="setup_quickstart.html">Setup</a></li>
      <li><a href="run_example_quickstart.html">Run Example</a></li>
      <li><a href="java_api_quickstart.html">Java API</a></li>
      <li><a href="scala_api_quickstart.html">Scala API</a></li>
    </ul>
  </li>

  <li>Setup &amp; Configuration
    <ul>
      <li><a href="local_setup.html">Local Setup</a></li>
      <li><a href="building.html">Build Flink</a></li>
      <li><a href="cluster_setup.html">Cluster Setup</a></li>
      <li><a href="yarn_setup.html">YARN Setup</a></li>
      <li><a href="config.html">Configuration</a></li>
    </ul>
  </li>

  <li>Programming Guides
    <ul>
      <li><a href="programming_guide.html">Programming Guide</a></li>
      <li><a href="dataset_transformations.html">DataSet Transformations</a></li>
      <li><a href="java8_programming_guide.html">Java 8 Programming Guide</a></li>
      <li><a href="streaming_guide.html">Streaming Guide</a></li>
      <li><a href="iterations.html">Iterations</a></li>
      <li><a href="spargel_guide.html">Spargel Graph API</a></li>
      <li><a href="hadoop_compatibility.html">Hadoop Compatibility</a></li>
    </ul>
  </li>

  <li>Examples
    <ul>
      <li><a href="examples.html">Bundled Examples</a></li>
      <li><a href="example_connectors.html">Connecting to other systems</a></li>
    </ul>
  </li>

  <li>Execution
    <ul>
      <li><a href="local_execution.html">Local/Debugging</a></li>
      <li><a href="cluster_execution.html">Cluster</a></li>
      <li><a href="cli.html">Command-Line Interface</a></li>
      <li><a href="web_client.html">Web Interface</a></li>
    </ul>
  </li>

  <li>Internals
    <ul>
      <li><a href="internal_overview.html">Overview</a></li>
    </ul>
  </li>
</ul>

        </div>  
        <div class="col-md-9">
          <h1>Quick Start: Run K-Means Example</h1>
	  
          <ul id="markdown-toc">
  <li><a href="#setup-flink">Setup Flink</a></li>
  <li><a href="#generate-input-data">Generate Input Data</a></li>
  <li><a href="#inspect-the-input-data">Inspect the Input Data</a></li>
  <li><a href="#start-flink">Start Flink</a></li>
  <li><a href="#inspect-and-run-the-k-means-example-program">Inspect and Run the K-Means Example Program</a></li>
  <li><a href="#shutdown-flink">Shutdown Flink</a></li>
  <li><a href="#analyze-the-result">Analyze the Result</a></li>
</ul>

<p>This guide walks you through the steps of executing an example program (<a href="http://en.wikipedia.org/wiki/K-means_clustering">K-Means clustering</a>) on Flink. On the way, you will see the a visualization of the program, the optimized execution plan, and track the progress of its execution.</p>

<h2 id="setup-flink">Setup Flink</h2>
<p>Follow the <a href="setup_quickstart.html">instructions</a> to setup Flink and enter the root directory of your Flink setup.</p>

<h2 id="generate-input-data">Generate Input Data</h2>
<p>Flink contains a data generator for K-Means.</p>

<div class="highlight"><pre><code class="language-bash"><span class="c"># Assuming you are in the root directory of your Flink setup</span>
mkdir kmeans
<span class="nb">cd </span>kmeans
<span class="c"># Run data generator</span>
java -cp ../examples/flink-java-examples-*-KMeans.jar org.apache.flink.examples.java.clustering.util.KMeansDataGenerator <span class="m">500</span> <span class="m">10</span> 0.08
cp /tmp/points .
cp /tmp/centers .</code></pre></div>

<p>The generator has the following arguments:</p>

<div class="highlight"><pre><code class="language-bash">KMeansDataGenerator &lt;numberOfDataPoints&gt; &lt;numberOfClusterCenters&gt; <span class="o">[</span>&lt;relative stddev&gt;<span class="o">]</span> <span class="o">[</span>&lt;centroid range&gt;<span class="o">]</span> <span class="o">[</span>&lt;seed&gt;<span class="o">]</span></code></pre></div>

<p>The <em>relative standard deviation</em> is an interesting tuning parameter. It determines the closeness of the points to randomly generated centers.</p>

<p>The <code>kmeans/</code> directory should now contain two files: <code>centers</code> and <code>points</code>. The <code>points</code> file contains the points to cluster and the <code>centers</code> file contains initial cluster centers.</p>

<h2 id="inspect-the-input-data">Inspect the Input Data</h2>
<p>Use the <code>plotPoints.py</code> tool to review the generated data points. <a href="quickstart/plotPoints.py">Download Python Script</a></p>

<div class="highlight"><pre><code class="language-bash">python plotPoints.py points ./points input</code></pre></div>

<p>Note: You might have to install <a href="http://matplotlib.org/">matplotlib</a> (<code>python-matplotlib</code> package on Ubuntu) to use the Python script.</p>

<p>You can review the input data stored in the <code>input-plot.pdf</code>, for example with Evince (<code>evince input-plot.pdf</code>).</p>

<p>The following overview presents the impact of the different standard deviations on the input data.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">relative stddev = 0.03</th>
      <th style="text-align: center">relative stddev = 0.08</th>
      <th style="text-align: center">relative stddev = 0.15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="img/quickstart-example/kmeans003.png" alt="example1" style="width: 275px;" /></td>
      <td style="text-align: center"><img src="img/quickstart-example/kmeans008.png" alt="example2" style="width: 275px;" /></td>
      <td style="text-align: center"><img src="img/quickstart-example/kmeans015.png" alt="example3" style="width: 275px;" /></td>
    </tr>
  </tbody>
</table>

<h2 id="start-flink">Start Flink</h2>
<p>Start Flink and the web job submission client on your local machine.</p>

<div class="highlight"><pre><code class="language-bash"><span class="c"># return to the Flink root directory</span>
<span class="nb">cd</span> ..
<span class="c"># start Flink</span>
./bin/start-local.sh
<span class="c"># Start the web client</span>
./bin/start-webclient.sh</code></pre></div>

<h2 id="inspect-and-run-the-k-means-example-program">Inspect and Run the K-Means Example Program</h2>
<p>The Flink web client allows to submit Flink programs using a graphical user interface.</p>

<div class="row" style="padding-top:15px">
	<div class="col-md-6">
		<a data-lightbox="example-1" href="img/quickstart-example/run-webclient.png"><img class="img-responsive" src="img/quickstart-example/run-webclient.png" /></a>
	</div>
	<div class="col-md-6">
		1. Open web client on  <a href="http://localhost:8080/launch.html">localhost:8080</a> <br />
		2. Upload the K-Mean job JAR file. 
			
<div class="highlight"><pre><code class="language-bash" data-lang="bash">./examples/flink-java-examples-*-KMeans.jar</code></pre></div>
 
		3. Select it in the left box to see how the operators in the plan are connected to each other. <br />
		4. Enter the arguments in the lower left box:
			
<div class="highlight"><pre><code class="language-bash" data-lang="bash">file://&lt;pathToFlink&gt;/kmeans/points file://&lt;pathToFlink&gt;/kmeans/centers file://&lt;pathToFlink&gt;/kmeans/result 10</code></pre></div>

			For example:
			
<div class="highlight"><pre><code class="language-bash" data-lang="bash">file:///tmp/flink/kmeans/points file:///tmp/flink/kmeans/centers file:///tmp/flink/kmeans/result 10</code></pre></div>

	</div>
</div>
<hr />

<div class="row" style="padding-top:15px">
	<div class="col-md-6">
		<a data-lightbox="example-1" href="img/quickstart-example/compiler-webclient-new.png"><img class="img-responsive" src="img/quickstart-example/compiler-webclient-new.png" /></a>
	</div>

	<div class="col-md-6">
		1. Press the <b>RunJob</b> to see the optimizer plan. <br />
		2. Inspect the operators and see the properties (input sizes, cost estimation) determined by the optimizer.
	</div>
</div>
<hr />

<div class="row" style="padding-top:15px">
	<div class="col-md-6">
		<a data-lightbox="example-1" href="img/quickstart-example/jobmanager-running-new.png"><img class="img-responsive" src="img/quickstart-example/jobmanager-running-new.png" /></a>
	</div>
	<div class="col-md-6">
		1. Press the <b>Continue</b> button to start executing the job. <br />
		2. <a href="http://localhost:8080/launch.html">Open Flink's monitoring interface</a> to see the job's progress. (Due to the small input data, the job will finish really quick!)<br />
		3. Once the job has finished, you can analyze the runtime of the individual operators.
	</div>
</div>

<h2 id="shutdown-flink">Shutdown Flink</h2>
<p>Stop Flink when you are done.</p>

<div class="highlight"><pre><code class="language-bash"><span class="c"># stop Flink</span>
./bin/stop-local.sh
<span class="c"># Stop the Flink web client</span>
./bin/stop-webclient.sh</code></pre></div>

<h2 id="analyze-the-result">Analyze the Result</h2>
<p>Use the <a href="quickstart/plotPoints.py">Python Script</a> again to visualize the result.</p>

<div class="highlight"><pre><code class="language-bash"><span class="nb">cd </span>kmeans
python plotPoints.py result ./result clusters</code></pre></div>

<p>The following three pictures show the results for the sample input above. Play around with the parameters (number of iterations, number of clusters) to see how they affect the result.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">relative stddev = 0.03</th>
      <th style="text-align: center">relative stddev = 0.08</th>
      <th style="text-align: center">relative stddev = 0.15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="img/quickstart-example/result003.png" alt="example1" style="width: 275px;" /></td>
      <td style="text-align: center"><img src="img/quickstart-example/result008.png" alt="example2" style="width: 275px;" /></td>
      <td style="text-align: center"><img src="img/quickstart-example/result015.png" alt="example3" style="width: 275px;" /></td>
    </tr>
  </tbody>
</table>

	  
        <!-- Disqus Area -->
          <div style="padding-top:30px" id="disqus_thread"></div>
      
            <script type="text/javascript">
                /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                var disqus_shortname = 'stratosphere-eu'; // required: replace example with your forum shortname

                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          </div>
        </div>

        <div class="footer">
          
          <hr class="divider" />

<p><small>Apache Flink is an effort undergoing incubation at The Apache Software
Foundation (ASF), sponsored by the Apache Incubator PMC. Incubation is
required of all newly accepted projects until a further review indicates that
the infrastructure, communications, and decision making process have
stabilized in a manner consistent with other successful ASF projects. While
incubation status is not necessarily a reflection of the completeness or
stability of the code, it does indicate that the project has yet to be fully
endorsed by the ASF.</small></p>

<p><a href="http://incubator.apache.org/"><img src="/img/apache-incubator-logo.png" alt="Incubator Logo" /></a></p>

<p class="text-center"><a href="privacy-policy.html">Privacy Policy<a>
</a></a></p>

        </div>
      </div>
    </div>

    

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');

    </script>

  </body>
</html>
